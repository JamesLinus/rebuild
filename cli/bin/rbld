#!/usr/bin/env ruby

require 'pp'
require 'colorize'
require_relative '../lib/rbld_log'
require_relative '../lib/rbld_commands'

begin

  rbld_log.info( "ARGV: #{ARGV.join(' ')}" )

  if ARGV[0] == "help" || !ARGV[0]
    if !ARGV[1]
      puts Rebuild::Main.usage
      puts
    else
      Rebuild::Commands.usage( ARGV[1] )
      exit 0
    end
  else
    Rebuild::Commands.run( ARGV[0], ARGV.drop(1) )
    exit 0
  end

rescue Rebuild::CommandError => error
  exit error.code

rescue RuntimeError => msg
  puts
  puts "\tERROR: #{msg}".light_red
  puts
  exit 1
end
